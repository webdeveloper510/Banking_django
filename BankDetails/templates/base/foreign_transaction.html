{% include 'base/header.html' %}
{% load static %}

<script src=" https://code.jquery.com/jquery-3.5.1.js"></script>

<!-- Breadcrumbs -->
<section class="section section-bredcrumbs">
    <div class="container context-dark breadcrumb-wrapper">
        <h1>
            Foreign Transaction Details</h1>
        <ul class="breadcrumbs-custom">
            <li><a href="index.html">Home</a></li>
            <li class="active">
                Foreign Transaction</li>
        </ul>
    </div>
</section>




<section class="container">
    <div class="text-center mt-5">
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist" style="    display: flex;
        justify-content: center;">
          <li onclick="setTab('pending');" class="nav-item">
            <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab"
              aria-controls="pills-home" aria-selected="true">Pending</a>
          </li>
          <li onclick="setTab('confirm');" class="nav-item">
            <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab"
              aria-controls="pills-profile" aria-selected="false">Confirm</a>
          </li>
          <li onclick="setTab('complete');" class="nav-item">
            <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab"
              aria-controls="pills-contact" aria-selected="false">Completed</a>
          </li>
        </ul>
    </div>
    <div class="tab-content my-3" id="pills-tabContent">
        <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">

            <div class="row">
                <div class="col"></div>
                <div class="col-md-3 mb-3">
                    <form id="dateform" method="post">
                        {% csrf_token %}
                        <label>Date :</label>
                        <input type="date" name="date" class="form-control date" id="datepicker">
                        <div class="text-right mt-3">
                        <button dataa-url="{% url 'date' %}" class="submit_btn text-right btn btn-primary">Apply</button>
                        </div>
                      </form>
                </div>
            </div>

            <div class="card p-3 ">

                <table id="Pending" class="table table-striped table-bordered" style="width:100%">

                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Accountnumber</th>
                            <th>From Bank</th>
                            <th>Status</th>
                            <th>Amount</th>
                            <th>ForienBank Routing Number</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for data in Transaction_pending %}
                        <tr>
                            <td>{{data.Name_id}}</td>
                            <td>{{data.Accountnumber}}</td>
                            <td>{{data.FromBank_id}}</td>
                            <td>{{data.status}}</td>
                            <td>{{data.amount}}</td>
                            <td>{{data.ForiegnBankrountingnumber_id}}</td>
                            <td><button data-url="{% url 'confirm_status' data.id %}"
                                    class="btn btn-success updateStatus" data-status="confirmed">Confirm</button></td>
                        </tr>
                        {% endfor %}

                    </tbody>
                </table>
            </div>
        </div>
        <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
            <div class="row">
                <div class="col"></div>
                <div class="col-md-3 mb-3">
                    <form id="dateform" method="post">
                        {% csrf_token %}
                        <label>Date :</label>
                        <input type="date" name="date" class="form-control date" id="datepicker">
                        <div class="text-right mt-3">
                        <button dataa-url="{% url 'date' %}" class="submit_btn text-right btn btn-primary">Apply</button>
                        </div>
                      </form>
                </div>
            </div>
            <div class="card p-3">

                <table id="Confirm" class="table table-striped table-bordered" style="width:100%">

                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Accountnumber</th>
                            <th>From Bank</th>
                            <th>Status</th>
                            <th>Amount</th>
                            <th>ForienBank Routing Number</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for data in Transaction_confirm %}
                        <tr>
                            <td>{{data.Name_id}}</td>
                            <td>{{data.Accountnumber}}</td>
                            <td>{{data.FromBank_id}}</td>
                            <td>{{data.status}}</td>
                            <td>{{data.amount}}</td>
                            <td>{{data.ForiegnBankrountingnumber_id}}</td>
                            {% endfor %}

                    </tbody>
                </table>
            </div>
        </div>
        <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
            <div class="row">
                <div class="col"></div>
                <div class="col-md-3 mb-3">
                    <form id="dateform" method="post">
                        {% csrf_token %}
                        <label>Date :</label>
                        <input type="date" name="date" class="form-control date" id="datepicker">
                        <div class="text-right mt-3">
                        <button dataa-url="{% url 'date' %}" class="submit_btn text-right btn btn-primary">Apply</button>
                        </div>
                      </form>
                </div>
            </div>
            <div class="card p-3">

                <table id="example" class="table table-striped table-bordered" style="width:100%">

                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Accountnumber</th>
                            <th>From Bank</th>
                            <th>Status</th>
                            <th>Amount</th>
                            <th>ForienBank Routing Number</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for data in Transaction_completed %}
                        <tr>
                            <td>{{data.Name_id}}</td>
                            <td>{{data.Accountnumber}}</td>
                            <td>{{data.FromBank_id}}</td>
                            <td>{{data.status}}</td>
                            <td>{{data.amount}}</td>
                            <td>{{data.ForiegnBankrountingnumber_id}}</td>
                        </tr>
                        {% endfor %}

                    </tbody>
                </table>
            </div>
        </div>
    </div>





    </div>
</section>
<!-- Call to action-->

</div>
<!-- PANEL-->
<script>
    var typeTab = 'pending';
  
    function setTab(type) {
      typeTab = type;
  
    }
  </script>


<script>
    $(document).ready(function () {
        $('#Pending').DataTable();
        $('#Confirm').DataTable();
        $('#example').DataTable();
    });
</script>
<script>
    $(function () {
        $("#datepicker").datepicker();
    });
</script>

{% include 'base/footer.html' %}


<script>
    $(".updateStatus").click(function () {
        var status = $(this).attr('data-status');
        console.log(status)
        var url = $(this).attr('data-url');
        $.ajax({
            type: "POST",
            headers: {
                "X-CSRFToken": '{{csrf_token}}'
            },
            url: url,
            data: {
                status: status
            }, //only input
            success: function (response) {
                console.log(response);
                window.setTimeout(function () {
                    location.reload();
                }, 1000);
            }
        });

    })
</script>